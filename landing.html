<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <title>LIBERI.WORLD</title>
  <meta name="description" content="">
  <meta name="author" content="Emre Can Eskimez">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
    

  <!--Animation.css-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
<link rel="stylesheet" href="css/master.css">


<script
src="https://code.jquery.com/jquery-3.4.1.min.js"
integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
crossorigin="anonymous"></script>

<link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">


<script src="/socket.io/socket.io.js"></script>



</head>




<body>
    

  
  


  <div class="mx-auto">

    <button id="btnHidden"  class="btnHid bg-gray-600 text-white p-2 rounded-full animated pulse infinite pointer"><a id="link" href="http://localhost:3000/emre">Enter the room</a> </button>

  </div>


<footer class="  bg-gray-300 w-full float-left  animated  slideInUp " id="form">


 

  <!-- Searchbox start-->
  <form id="searchbox"  class=" " >
      
      <div class="p-3 flex items-center shadow py-2">
           
          <img class="pointer shadow-md" id="hide" src="/images/spy.png" style="width: 2.5em;" alt="">
                     
                    
        <input id="search" class="appearance-none bg-transparent border-none w-full text-black-700 mr-3 py-1 px-2 leading-tight focus:outline-none" type="text" placeholder="Room Name" aria-label="Full name">
        <button class=" mr-5 float-right  bg-transparent text-black  ">
              <i id="searchButton" class=" fab fa-searchengin fa-2x  "></i>
            </button>
       
      </div>
    </form>

  <!-- Search box end-->



</footer>







<script>

  /* locally used roomName trim fnc start*/

  function htmlRoom(x){
    
    
    let tempRoom = x;
    
    tempRoom = tempRoom.replace(/ /g,'-'); //removed whitespace
    
    

     return tempRoom;
   
}

/* locally used roomName trim fnc end*/

 
  function HtmlEncode(s)
 {
   var el = document.createElement("div");
   el.innerText = el.textContent = s;
   s = el.innerHTML;
   return s;
 }
 var  socket =  io.connect();
 //var  socket =  io.connect('165.227.139.7:3000');  BU KOMUTLA SERVERA BAĞLAYABİLİRİM CLIENTI CORDOVAYA TAŞIYABİLRİM 
 var $searchbox = $('#searchbox');
 var  $search = $('#search');
 var link = document.getElementById('link');
 
  
 
 $searchbox.submit(function(e){
 
   e.preventDefault();
 
 
   if($search.val() != '' && $search.val() != ' ' )  {  //burda bütünboşlukları trimletebilirim
 
     



         /* locally used roomName trim fnc start*/


              function htmlRoom(x){
          
          
                    let tempRoom = x;
                    
                    tempRoom = tempRoom.replace(/ /g,'-');
                    
                    

                    return tempRoom;
                  
                          }

/* locally used roomName trim fnc end*/

    
 
     //buraya xss tagları removelatacağım
 
   //serverdaki send message fonksiyonuna gidiyor
   socket.emit('search', HtmlEncode($search.val()));
   //set link value
   var path = '/'+htmlRoom($search.val()); //boşlukları removladı
   link.setAttribute('href',path);
   //visible
	$('#btnHidden').animate({opacity: "1"});   
   
   $search.val('');
 
 } 
 
 else  
   console.log("You cant send an empty message");
   
 
 });






 $("#searchButton").click(function(f) {
  f.preventDefault();
  









  let room=HtmlEncode($search.val());

  if($search.val() != '' && $search.val() != ' ' )  { 


    socket.emit('search', room );
    
  var path = '/'+htmlRoom(room);
  link.setAttribute('href',path);
  //document.getElementById("btnHidden").style.visibility = "visible";

  $('#btnHidden').animate({opacity: "1"});
  }

  else
  console.log("You cant send an empty message");

 });




  
  </script>












</body>
</html>

<script src="js/animations.js"></script>

